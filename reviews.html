<!DOCTYPE html>
<html>
<head>
  <!-- Site made with Mobirise Website Builder v6.0.6, https://mobirise.com -->
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Mobirise v6.0.6, mobirise.com">
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
  <link rel="shortcut icon" href="assets/images/smokymountainretrieverslogo-96x91.png" type="image/x-icon">
  <meta name="description" content="">

  <title>All Reviews</title>
  <link rel="stylesheet" href="assets/web/assets/mobirise-icons2/mobirise2.css">
  <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
  <link rel="stylesheet" href="assets/bootstrap/css/bootstrap-grid.min.css">
  <link rel="stylesheet" href="assets/bootstrap/css/bootstrap-reboot.min.css">
  <link rel="stylesheet" href="assets/animatecss/animate.css">
  <link rel="stylesheet" href="assets/dropdown/css/style.css">
  <link rel="stylesheet" href="assets/socicon/css/styles.css">
  <link rel="stylesheet" href="assets/theme/css/style.css">
  <link rel="stylesheet" href="assets/gallery/style.css">
  <link rel="preload" href="https://fonts.googleapis.com/css?family=Inter+Tight:100,200,300,400,500,600,700,800,900,100i,200i,300i,400i,500i,600i,700i,800i,900i&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter+Tight:100,200,300,400,500,600,700,800,900,100i,200i,300i,400i,500i,600i,700i,800i,900i&display=swap"></noscript>
  <link rel="preload" as="style" href="assets/mobirise/css/mbr-additional.css?v=b85cvj"><link rel="stylesheet" href="assets/mobirise/css/mbr-additional.css?v=b85cvj" type="text/css">
  <style>
    .reviews-header {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      justify-content: space-between;
      gap: 1rem;
      text-align: center;
    }

    .reviews-header .mbr-section-title,
    .reviews-header .mbr-text {
      text-align: left;
    }

    .reviews-sort {
      min-width: 220px;
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
      color: #1f1f1f;
    }

    .reviews-sort label {
      margin-bottom: 0;
      color: inherit;
    }

    .reviews-sort select {
      background-color: #ffffff;
      border: 1px solid #ced4da;
      color: #1f1f1f;
    }

    .review-stars {
      color: #f4b400;
      display: inline-flex;
      font-size: 1.2rem;
      letter-spacing: 0.12em;
      margin-top: 0.5rem;
      margin-bottom: 0.5rem;
      font-weight: 600;
      text-shadow: 0 1px 1px rgba(0, 0, 0, 0.15);
    }

    @media (max-width: 991px) {
      .reviews-header {
        justify-content: center;
      }

      .reviews-header .mbr-section-title,
      .reviews-header .mbr-text {
        text-align: center;
      }
    }
  </style>
</head>
<body>
  <section data-bs-version="5.1" class="menu menu2 cid-tJS6tZXiPa" once="menu" id="menu02-reviews">
    <nav class="navbar navbar-dropdown navbar-fixed-top navbar-expand-lg">
      <div class="container">
        <div class="navbar-brand">
          <span class="navbar-logo">
            <a href="index.html">
              <img src="assets/images/smokymountainretrieverslogo-96x91.png" alt="Smoky Mountain Retrievers" style="height: 3rem;">
            </a>
          </span>
          <span class="navbar-caption-wrap"><a class="navbar-caption text-black text-primary display-4" href="index.html">Smoky Mountain Retrievers</a></span>
        </div>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbarSupportedContent" data-bs-target="#navbarSupportedContent" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
          <div class="hamburger">
            <span></span>
            <span></span>
            <span></span>
            <span></span>
          </div>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav nav-dropdown nav-right" data-app-modern-menu="true">
            <li class="nav-item">
              <a class="nav-link link text-black text-primary display-4" href="index.html#people04-1i">Testimonials</a>
            </li>
            <li class="nav-item">
              <a class="nav-link link text-black text-primary display-4" href="review.html">Leave a Review</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>
  </section>

  <section data-bs-version="5.1" class="people04 cid-all-reviews" id="all-reviews">
    <div class="container">
      <div class="row mb-5 justify-content-center">
        <div class="col-12 mb-0 content-head reviews-header">
          <div>
            <h3 class="mbr-section-title mbr-fonts-style align-center mb-0 display-2">
              <strong>All Reviews</strong>
            </h3>
            <p class="mbr-text mbr-fonts-style align-center mt-4 display-7">Browse every story from our Smoky Mountain Retrievers families.</p>
          </div>
          <div class="reviews-sort">
            <label class="mbr-text mbr-fonts-style display-7" for="reviews-sort">Sort by stars</label>
            <select class="form-control" id="reviews-sort">
              <option value="high">Highest to lowest</option>
              <option value="low">Lowest to highest</option>
            </select>
          </div>
        </div>
      </div>
      <div class="row mbr-masonry" id="all-reviews-list" data-masonry="{&quot;percentPosition&quot;: true }">
        <div class="col-12">
          <p class="mbr-text mbr-fonts-style align-center display-7" id="all-reviews-status">Loading reviews...</p>
        </div>
      </div>
    </div>
  </section>

  <section data-bs-version="5.1" class="footer3 cid-tJS6tZXiPb" id="footer3-reviews">
    <div class="container">
      <div class="row align-center mbr-white">
        <div class="col-12">
          <p class="mbr-text mb-0 mbr-fonts-style display-7">
            <a class="text-white" href="index.html#people04-1i">Back to Testimonials</a>
          </p>
        </div>
      </div>
    </div>
  </section>

  <script src="assets/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="assets/smoothscroll/smooth-scroll.js"></script>
  <script src="assets/ytplayer/index.js"></script>
  <script src="assets/dropdown/js/navbar-dropdown.js"></script>
  <script src="assets/masonry/masonry.pkgd.min.js"></script>
  <script src="assets/imagesloaded/imagesloaded.pkgd.min.js"></script>
  <script src="assets/theme/js/script.js"></script>
  <script>
    const reviewsList = document.getElementById("all-reviews-list");
    const reviewsStatus = document.getElementById("all-reviews-status");
    const reviewsSort = document.getElementById("reviews-sort");
    let cachedReviews = [];

    const normalizeReviews = (payload) => {
      if (Array.isArray(payload)) {
        return payload;
      }
      if (payload && Array.isArray(payload.reviews)) {
        return payload.reviews;
      }
      return [];
    };

    const parseRating = (value) => {
      if (typeof value === "number" && !Number.isNaN(value)) {
        return value;
      }
      if (typeof value === "string") {
        const match = value.match(/[\d.]+/);
        return match ? Number(match[0]) : 0;
      }
      return 0;
    };

    const sortReviews = (reviews, direction) => {
      return [...reviews].sort((a, b) => {
        const ratingA = parseRating(a.rating);
        const ratingB = parseRating(b.rating);
        return direction === "low" ? ratingA - ratingB : ratingB - ratingA;
      });
    };

    const renderReviews = (reviews) => {
      reviewsList.innerHTML = "";
      if (!reviews.length) {
        reviewsList.innerHTML = `
          <div class="col-12">
            <p class="mbr-text mbr-fonts-style align-center display-7">No reviews yet. Be the first to share your story!</p>
          </div>
        `;
        return;
      }

      reviews.forEach((review) => {
        const name = review.name || "Happy Customer";
        const message = review.message || "";
        const ratingValue = parseRating(review.rating);
        const clampedRating = Math.min(Math.max(ratingValue, 0), 5);
        const stars = "★★★★★".slice(0, clampedRating).padEnd(5, "☆");

        const item = document.createElement("div");
        item.className = "item features-without-image col-12 col-md-6 col-lg-4";
        item.innerHTML = `
          <div class="item-wrapper">
            <div class="card-box align-left">
              <p class="card-text mbr-fonts-style display-7">${message}</p>
              <div class="mbr-text mbr-fonts-style display-7 review-stars" aria-label="${clampedRating} out of 5 stars">
                <span aria-hidden="true">${stars}</span>
              </div>
              <h5 class="card-title mbr-fonts-style display-7">${name}</h5>
            </div>
          </div>
        `;
        reviewsList.appendChild(item);
      });
    };

    const updateReviews = () => {
      const direction = reviewsSort ? reviewsSort.value : "high";
      const sortedReviews = sortReviews(cachedReviews, direction);
      renderReviews(sortedReviews);
    };

    const loadReviews = async () => {
      try {
        const response = await fetch("/reviews");
        if (!response.ok) {
          throw new Error("Failed to load reviews.");
        }
        const payload = await response.json();
        cachedReviews = normalizeReviews(payload);
        updateReviews();
      } catch (error) {
        if (reviewsStatus) {
          reviewsStatus.textContent = "Reviews are unavailable right now. Please check back soon.";
        }
      }
    };

    if (reviewsSort) {
      reviewsSort.addEventListener("change", updateReviews);
    }

    if (reviewsList) {
      loadReviews();
    }
  </script>
</body>
</html>
